name: Flutter Forced Clean Build
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.19.0'
      
      - name: ğŸ”¥ Deep Clean & Force Fresh Structure
        run: |
          # ØªÙ†Ø¸ÙŠÙ ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø®Ù„ÙØ§Øª
          flutter clean
          rm -rf build
          
          # Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø¨Ø§Ø³Ù… Ø­Ø²Ù…Ø© ØµØ­ÙŠØ­ (com.ibrahim.fastbridge)
          # Ù„Ø§Ø­Ø¸ Ø´Ù„Ù†Ø§ ÙƒÙ„Ù…Ø© new Ø¹Ø´Ø§Ù† Ù…ÙŠØ¹Ù…Ù„Ø´ Error Ø¬Ø§ÙØ§
          flutter create --org com.ibrahim.fastbridge --project-name fastbridge_app . --overwrite
          
          # ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ù…Ù† Ø§Ù„ØµÙØ±
          flutter pub get

      - name: ğŸ—ï¸ Build Fresh APK
        run: flutter build apk --release

      - name: ğŸš€ Send Fresh APK to Telegram
        run: |
          curl -F "chat_id=1857967143" \
               -F "document=@build/app/outputs/flutter-apk/app-release.apk" \
               -F "caption=ğŸ¯ ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­! Ø¯Ù‡ ØªØ·Ø¨ÙŠÙ‚ FastBridge Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ." \
               "https://api.telegram.org/bot8247992344:AAHUK1O7IqQJyeZ44TOh7v93kgWtb6yA1WU/sendDocument"
